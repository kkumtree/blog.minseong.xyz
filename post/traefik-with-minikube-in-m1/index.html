<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="apple-icon-180x180" sizes="180x180" href='/img/favicon/apple-icon-180x180.png'>
    <link rel="icon" type="image/png" sizes="32x32" href='/img/favicon/favicon-32x32.png'>
    <link rel="icon" type="image/png" sizes="16x16" href='/img/favicon/favicon-16x16.png'>
    <title>Traefikì„ í™œìš©í•œ minikube ì˜ˆì œ êµ¬í˜„ì‹œë„ w/Apple Silicon | kkumtree</title>
    
    <meta property="og:site_name" content="kkumtree" />
    <meta property="og:title" content="Traefikì„ í™œìš©í•œ minikube ì˜ˆì œ êµ¬í˜„ì‹œë„ w/Apple Silicon" />

    
    <meta property="og:image" content='https://blog.minseong.xyz/post/traefik-with-minikube-in-m1/cover.png' />
    <meta property="og:image:secure_url" content='https://blog.minseong.xyz/post/traefik-with-minikube-in-m1/cover.png' />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content='https://blog.minseong.xyz/post/traefik-with-minikube-in-m1/cover.png' />

    
    <link rel="stylesheet" href="https://blog.minseong.xyz/sass/theme.min.05bc9a89b9988ba7449154a7ccd83133b7df79fac13cc1945cffac151ac54dbb.css">
</head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GCJ1CESNKD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GCJ1CESNKD');
</script><body><header id="navigation" class="p-navigation is-dark">
  <div class="p-navigation__row">
    <div class="p-navigation__banner">
      <div class="p-navigation__tagged-logo" style="min-width: 6rem;">
        <a class="p-navigation__link" href="/">
          <div class="p-navigation__logo-tag">
            <img class="p-navigation__logo-icon" src="/img/BlogWhite.svg" alt="">
          </div>
          <span class="p-navigation__logo-title">Blog</span>
        </a>
      </div>
      <a href="#navigation" class="p-navigation__toggle--open" title="menu">Menu</a>
      <a href="#navigation-closed" class="p-navigation__toggle--close" title="close menu">Close menu</a>
    </div>
    <nav class="p-navigation__nav" aria-label="Example sub navigation">
      <ul class="p-navigation__items">
        
      </ul>
     
     <ul class="p-navigation__items">
        <li class="p-navigation__item--dropdown-toggle" id="link-4">
          <a class="p-navigation__link" aria-controls="account-menu">
            ğŸŒ
          </a>
          <ul class="p-navigation__dropdown--right" id="account-menu" aria-hidden="true">
            
            
            
          </ul>
        </li>
        <li class="p-navigation__item--dropdown-toggle" id="link-4">
          <a class="p-navigation__link" aria-controls="account-menu">
            ğŸ”—
          </a>
          <ul class="p-navigation__dropdown--right" id="account-menu" aria-hidden="true">
            
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>
<div id="content">


<main>
  <section class="p-strip--image main-strip"
    }
    style="background-image:url('cover.png'); background-position: center; background-repeat: no-repeat; background-size: cover;"
    >
      <div class="row">
        
        <div class="col-6">
          <div class="p-card--overlay">
            <h2>Traefikì„ í™œìš©í•œ minikube ì˜ˆì œ êµ¬í˜„ì‹œë„ w/Apple Silicon</h2>
            <ul class="p-card__content p-inline-list--middot">
              
              <li class="p-inline-list__item">
                kkumtree
              </li>
              
            </ul>
            <p><u class=" timedisplay" style="text-decoration-style: dotted;">2023-02-05T04:54:06&#43;09:00</u></p>
            <p class="p-card__content"></p>
            
            <a href="/tags/minikube" class="tag">
              <div class="p-chip">
                <span class="p-chip__value">minikube</span>
              </div>
            </a>
            
            <a href="/tags/cloudnet@" class="tag">
              <div class="p-chip">
                <span class="p-chip__value">CloudNet@</span>
              </div>
            </a>
            
            <a href="/tags/m1" class="tag">
              <div class="p-chip">
                <span class="p-chip__value">M1</span>
              </div>
            </a>
            
            <a href="/tags/traefik" class="tag">
              <div class="p-chip">
                <span class="p-chip__value">Traefik</span>
              </div>
            </a>
            
          </div>
        </div>
        
      </div>
  </section>
  <section class="p-strip">
  <div class="row">
  <pre tabindex="0"><code class="language-deprecated" data-lang="deprecated">ì£¼ë³€ìœ¼ë¡œë¶€í„° í”¼ë“œë°±ì„ ë°›ì€ ë‚´ìš©ì´ ìˆì–´ ìƒˆë¡œìš´ ê¸€ë¡œ ë³´ì™„ì˜ˆì •ì…ë‹ˆë‹¤. 
- colimaëŠ” containerdì²˜ëŸ¼ criê°€ ì•„ë‹Œ, Docker engineê³¼ containerd ì‚¬ì´ì˜ ë¬¼ê±´ìœ¼ë¡œ ì¶”ì •ë©ë‹ˆë‹¤. 
  - ë„ì»¤ ì—”ì§„ì€ í˜„ì¬ containerdë¥¼ í†µí•´ í”„ë¡œì„¸ìŠ¤ë¥¼ ê´€ë¦¬.
  - colimaë„ docker shim êµ¬ì¡°ëŠ” íƒˆí”¼í–ˆì„ ê±°ë¼ê³  ì¶”ì¸¡ ì¤‘. 
  - ë„ì»¤ ì—”ì§„ê³¼ containerd ì‚¬ì´ì˜ ì»¨í…Œì´ë„ˆ ì—”ì§„(ê´€ë¦¬ë„êµ¬?)ë¡œ ë³´ì„
- colima ì‹œì‘ ì‹œ, íŠ¹ì • ëŸ°íƒ€ì„ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬¸ì„œë¥¼ ì˜ ì½ì–´ë´…ì‹œë‹¤.
  `colima start --runtime containerd`
- k8së¥¼ ìœ„í•œ colima ì‹œì‘ ëª…ë ¹ì–´ëŠ” ë³„ë„ë¡œ ìˆìŠµë‹ˆë‹¤. colima githubë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”.
</code></pre><pre tabindex="0"><code class="language-notice" data-lang="notice">traefik v1.7ì—ì„œëŠ” ì˜ˆì œ ì„¤ëª…ì˜ ê¸°ì¤€ì´
k8s.io/v1beta1 API(deprecated)ì…ë‹ˆë‹¤   
k8s.io/v1 APIë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì–´ ìˆìœ¼ë‹ˆ, ì°¸ê³ ë°”ëë‹ˆë‹¤.
</code></pre><p>ë¡œì»¬í™˜ê²½(minikube)ì—ì„œ Traefik(^2) ì˜ˆì œë¥¼ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<h2 id="00-pre-requisite">00. Pre-requisite</h2>
<ul>
<li>Apple Silicon M1, macOS <strong>Monterey</strong>: ^12.6.3
<ul>
<li>macOS Venturaë¥¼ ì‚¬ìš©í•˜ì‹ ë‹¤ë©´, Colima ì˜µì…˜ ì„¤ì • ë° ì‹œì‘ ë¶€ë¶„ì˜ ëª…ë ¹ì–´ ì£¼ì„ì„ ì°¸ì¡°.</li>
</ul>
</li>
<li><a href="https://formulae.brew.sh/formula/colima">Colima</a>: ^0.5.2, <strong>Container Runtime</strong></li>
<li><a href="https://formulae.brew.sh/formula/minikube">minikube</a>: ^1.29.0, ë¡œì»¬í™˜ê²½ì—ì„œì˜ k8s í´ëŸ¬ìŠ¤í„° êµ¬ì„±</li>
<li><a href="https://formulae.brew.sh/formula/kubernetes-cli">kubectl</a>: ^v1.26.1
<ul>
<li>
<p><a href="https://krew.sigs.k8s.io/docs/user-guide/setup/install/#bash">krew</a> ì„¤ì¹˜ë¥¼ ì¶”ì²œë“œë¦½ë‹ˆë‹¤ (ctx ë° ns ì„¤ì¹˜ëœ í™˜ê²½ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl krew install ctx ns
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h2 id="01-krew-í™˜ê²½-ì„¤ì •">01. Krew í™˜ê²½ ì„¤ì •</h2>
<ul>
<li>
<p>Brew ê¸°ì¤€, ì„¤ì¹˜ ì‹œ ì¶”ê°€ ì•ˆë‚´ê°€ ìˆì„ ê²ƒì…ë‹ˆë‹¤. oh-my-<strong>zsh</strong>ì„ ì‚¬ìš©í•˜ê³  ìˆê¸°ì—, ì•„ë˜ì™€ ê°™ì´ ~/.zshrcì— ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p>ì‰˜ ì¬ì‹¤í–‰ì´ ë²ˆê±°ë¡­ë‹¤ë©´, ì„¤ì • ì´í›„ì— <code>source ~/.zshrc</code>ë¥¼ ì‹¤í–‰í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/.krew/bin&#34;</span>
</span></span><span style="display:flex;"><span>source &lt;<span style="color:#f92672">(</span>kubectl completion zsh<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>alias k<span style="color:#f92672">=</span>kubectl
</span></span><span style="display:flex;"><span>complete -F __start_kubectl k
</span></span></code></pre></div></li>
</ul>
<h2 id="02-colima-ì˜µì…˜-ì„¤ì •-ë°-ì‹œì‘">02. Colima ì˜µì…˜ ì„¤ì • ë° ì‹œì‘</h2>
<ul>
<li>
<p>Colimaë¥¼ ì„¤ì¹˜í•˜ê³ , ì•„ë˜ì™€ ê°™ì´ ì˜µì…˜ì„ ì„¤ì •í•©ë‹ˆë‹¤.</p>
<ul>
<li>cpuê°’ì´ë‚˜ memoryê°’, disk ê°’ì€ ë¨¸ì‹  í™˜ê²½ì´ë‚˜ í•„ìš”ì— ë”°ë¼ ì¡°ì ˆí•˜ì‹œë©´ ë©ë‹ˆë‹¤.</li>
<li>ì•„ë˜ ì˜ˆì œëŠ” 4core, 8GB, 20GBì˜ í™˜ê²½ì„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</li>
</ul>
</li>
<li>
<p>macOS Venturaë¥¼ ì‚¬ìš©í•˜ì‹ ë‹¤ë©´, ë‘ ë²ˆì§¸ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># if colima is running, stop it by `colima stop`</span>
</span></span><span style="display:flex;"><span>colima start --cpu <span style="color:#ae81ff">4</span> --memory <span style="color:#ae81ff">8</span> --disk <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if you are using macOS Ventura</span>
</span></span><span style="display:flex;"><span>colima start --arch aarch64 --vm-type<span style="color:#f92672">=</span>vz --vz-rosetta --cpu <span style="color:#ae81ff">4</span> --memory <span style="color:#ae81ff">8</span> --disk <span style="color:#ae81ff">20</span>
</span></span></code></pre></div><ul>
<li>
<p>prompt</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> starting colima
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> runtime: docker
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> preparing network ...                         context<span style="color:#f92672">=</span>vm
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> starting ...                                  context<span style="color:#f92672">=</span>vm
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0021<span style="color:#f92672">]</span> provisioning ...                              context<span style="color:#f92672">=</span>docker
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0021<span style="color:#f92672">]</span> starting ...                                  context<span style="color:#f92672">=</span>docker
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0026<span style="color:#f92672">]</span> <span style="color:#66d9ef">done</span>
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="03-minikube-ì˜µì…˜-ì„¤ì •-ë°-ì‹œì‘">03. minikube ì˜µì…˜ ì„¤ì • ë° ì‹œì‘</h3>
<ul>
<li>
<p>ë‹¤ìŒì˜ ì˜µì…˜ìœ¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤. ì—ëŸ¬ê°€ ì¶œë ¥ë˜ë©´, ëŒ€ê°œ ìì› ë¶€ì¡±ì´ê¸° ë•Œë¬¸ì— ì˜µì…˜ì„ ì¡°ì ˆí•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>minikube config set cpus <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>minikube config set memory 8G <span style="color:#75715e"># 8GB, 8192ë¡œ ì„¤ì •í•´ë„ ë©ë‹ˆë‹¤.</span>
</span></span><span style="display:flex;"><span>minikube config set disk <span style="color:#ae81ff">20</span> <span style="color:#75715e"># 20GB, 20Gë¡œ ì„¤ì •í•´ë„ ë©ë‹ˆë‹¤.</span>
</span></span><span style="display:flex;"><span>minikube config set driver docker <span style="color:#75715e"># colima(docker driverë¡œ ì¸ì‹)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. </span>
</span></span><span style="display:flex;"><span>minikube start
</span></span></code></pre></div><ul>
<li>
<p>prompt</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ğŸ˜„  minikube v1.29.0 on Darwin 12.6.3 <span style="color:#f92672">(</span>arm64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>âœ¨  Using the docker driver based on user configuration
</span></span><span style="display:flex;"><span>ğŸ“Œ  Using Docker Desktop driver with root privileges
</span></span><span style="display:flex;"><span>ğŸ‘  Starting control plane node minikube in cluster minikube
</span></span><span style="display:flex;"><span>ğŸšœ  Pulling base image ...
</span></span><span style="display:flex;"><span>ğŸ”¥  Creating docker container <span style="color:#f92672">(</span>CPUs<span style="color:#f92672">=</span>4, Memory<span style="color:#f92672">=</span>7938MB<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex;"><span>ğŸ³  Preparing Kubernetes v1.26.1 on Docker 20.10.23 ...
</span></span><span style="display:flex;"><span>    â–ª Generating certificates and keys ...
</span></span><span style="display:flex;"><span>    â–ª Booting up control plane ...
</span></span><span style="display:flex;"><span>    â–ª Configuring RBAC rules ...
</span></span><span style="display:flex;"><span>ğŸ”—  Configuring bridge CNI <span style="color:#f92672">(</span>Container Networking Interface<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex;"><span>    â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5
</span></span><span style="display:flex;"><span>ğŸŒŸ  Enabled addons: storage-provisioner, default-storageclass
</span></span><span style="display:flex;"><span>ğŸ”  Verifying Kubernetes components...
</span></span><span style="display:flex;"><span>ğŸ„  Done! kubectl is now configured to use <span style="color:#e6db74">&#34;minikube&#34;</span> cluster and <span style="color:#e6db74">&#34;default&#34;</span> namespace by default
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>minikubeê°€ ì •ìƒì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl get nodes
</span></span><span style="display:flex;"><span><span style="color:#75715e"># NAME       STATUS   ROLES           AGE   VERSION</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># minikube   Ready    control-plane   10m   v1.26.1</span>
</span></span></code></pre></div><ul>
<li>
<p>minikube í™˜ê²½ì—ì„œëŠ” ingress í™œì„±í™”ë¥¼ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>minikube addons enable ingress
</span></span><span style="display:flex;"><span><span style="color:#75715e"># After enabled</span>
</span></span><span style="display:flex;"><span>sudo minikube tunnel
</span></span></code></pre></div></li>
<li>
<p>prompt</p>
<ul>
<li>ì‹œì‘ ì „ ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì¼œì„œ minikube tunnelì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤. (ì‹¤ìŠµ ì¢…ë£Œ ì‹œê¹Œì§€ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ğŸ’¡  ingress is an addon maintained by Kubernetes. For any concerns contact minikube on GitHub.
</span></span><span style="display:flex;"><span>You can view the list of minikube maintainers at: https://github.com/kubernetes/minikube/blob/master/OWNERS
</span></span><span style="display:flex;"><span>ğŸ’¡  After the addon is enabled, please run <span style="color:#e6db74">&#34;minikube tunnel&#34;</span> and your ingress resources would be available at <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>
</span></span><span style="display:flex;"><span>    â–ª Using image registry.k8s.io/ingress-nginx/controller:v1.5.1
</span></span><span style="display:flex;"><span>    â–ª Using image registry.k8s.io/ingress-nginx/kube-webhook-certgen:v20220916-gd32f8c343
</span></span><span style="display:flex;"><span>    â–ª Using image registry.k8s.io/ingress-nginx/kube-webhook-certgen:v20220916-gd32f8c343
</span></span><span style="display:flex;"><span>ğŸ”  Verifying ingress addon...
</span></span><span style="display:flex;"><span>ğŸŒŸ  The <span style="color:#e6db74">&#39;ingress&#39;</span> addon is enabled
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h2 id="04-ì˜ˆì œ-ì ìš©í•´ë³´ê¸°">04. ì˜ˆì œ ì ìš©í•´ë³´ê¸°</h2>
<ul>
<li>ì•„ë˜ì˜ ìŠ¤í¬ë¦½íŠ¸ë“¤ì€ ë‹¤ìŒ repositoryì—ì„œë„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<ul>
<li><a href="https://github.com/kkumtree/traefik-practice/tree/main/00_quickstart">github</a></li>
</ul>
</li>
<li>í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë“¤ì€ <a href="https://doc.traefik.io/traefik/getting-started/quick-start/">Traefik ê³µì‹ ë¬¸ì„œ</a>ì™€ ë™ì¼ ë‚´ìš©ì…ë‹ˆë‹¤.</li>
</ul>
<h3 id="04-1-clusterrole-ì ìš©">04-1. ClusterRole ì ìš©</h3>
<ul>
<li>
<p>ê³µì‹ ë¬¸ì„œê°€ ì œì¼ ì •í™•í•©ë‹ˆë‹¤.</p>
<ul>
<li>Traefikì€ k8s APIë¥¼ í†µí•´ svcë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.</li>
<li>í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ìê°€ ì—­í• ì„ ì •ì˜í•´ì•¼í•˜ë¯€ë¡œ, ClusterRoleì„ ì ìš©í•©ë‹ˆë‹¤.</li>
</ul>
</li>
<li>
<p>script</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwd
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ${HOME}/traefik-practice/00_quickstart</span>
</span></span><span style="display:flex;"><span>apply -f 00-role.yml
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ClusterRole</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">rbac.authorization.k8s.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-role</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">apiGroups</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">services</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">endpoints</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">secrets</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">verbs</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">get</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">list</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">watch</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">apiGroups</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">extensions</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">networking.k8s.io</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ingresses</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ingressclasses</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">verbs</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">get</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">list</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">watch</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">apiGroups</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">extensions</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">networking.k8s.io</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">ingresses/status</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">verbs</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ae81ff">update</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
</li>
</ul>
<h3 id="04-2-traefik-ì „ìš©-serviceaccount-ìƒì„±">04-2. Traefik ì „ìš© ServiceAccount ìƒì„±</h3>
<ul>
<li>
<p>ìœ„ì—ì„œ ì •ì˜í•œ ClusterRoleì„ ì ìš©í•  ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p>IAMì— ë¹—ëŒ€ë©´, IAM Roleì„ ì ìš©í•  ì„œë¹„ìŠ¤ ê³„ì •ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ë¼ê³  ë³´ë©´ ë˜ê² ë„¤ìš”.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwd
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ${HOME}/traefik-practice/00_quickstart</span>
</span></span><span style="display:flex;"><span>apply -f 01-account.yml
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ServiceAccount</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-account</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
</li>
</ul>
<h3 id="04-3-clusterrolebinding-ì ìš©">04-3. ClusterRoleBinding ì ìš©</h3>
<ul>
<li>
<p>ë‹¹ì—°í•œ ì´ì•¼ê¸°ì§€ë§Œ, ClusterRoleê³¼ ServiceAccountì„ ì ìš©í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwd
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ${HOME}/traefik-practice/00_quickstart</span>
</span></span><span style="display:flex;"><span>apply -f 02-role-binding.yml
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ClusterRoleBinding</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">rbac.authorization.k8s.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-role-binding</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">roleRef</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">apiGroup</span>: <span style="color:#ae81ff">rbac.authorization.k8s.io</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ClusterRole</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-role</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">subjects</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ServiceAccount</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-account</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">default</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
</li>
</ul>
<h3 id="04-4-traefik-servicesdashboard-lb-ì ìš©">04-4. traefik services(dashboard, LB) ì ìš©</h3>
<ul>
<li>
<p>traefikì˜ ê¸°ëŠ¥ì¸ dashboardì™€ LoadBalancerë¥¼ ì„œë¹„ìŠ¤í•´ë´…ì‹œë‹¤.</p>
<ul>
<li>ì‚¬ì‹¤ì€ ë¡œë“œë°¸ëŸ°ì‹±ì„ í†µí•´ dashboardì— 8080 í¬íŠ¸í¬ì›Œë”© í•´ì£¼ëŠ” ê²ƒì´ì§€ìš”.</li>
<li>80í¬íŠ¸ì˜ ê²½ìš°, ë‹¤ìŒ ìŠ¤í…ì¸ whoami í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í¬íŠ¸í¬ì›Œë”© ì‘ì—…ì…ë‹ˆë‹¤.</li>
</ul>
</li>
<li>
<p>ingressë„ ê²°êµ­ì—” pod ë° serviceë¥¼ í†µí•´ ë™ì‘í•˜ëŠ” ê²ƒì´ë¯€ë¡œ,
traefik <code>Deployment</code>ë¥¼ êµ¬ì„±í•˜ì—¬ ì¶”ê°€ì ìœ¼ë¡œ ì»¨í…Œì´ë„ˆë¥¼ í™•ì¥í•˜ë„ë¡ êµ¬í˜„í•˜ëŠ” ì‘ì—…ì´ë¼ê³  í•©ë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwd
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ${HOME}/traefik-practice/00_quickstart</span>
</span></span><span style="display:flex;"><span>apply -f 03-traefik-services.yml
</span></span></code></pre></div></li>
<li>
<p>kubectl tunneling í™œì„±í™”</p>
<ul>
<li>
<p>ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´, ì‚¬ì „ì— ë§ì”€ë“œë¦° í„°ë¯¸ë„ ì°½ì—ì„œ ì•”í˜¸ë¥¼ ì…ë ¥í•˜ë¼ê³  ëœ° ê²ƒì…ë‹ˆë‹¤.</p>
</li>
<li>
<p>ì•„ë˜ ì˜ˆì œì²˜ëŸ¼, ì¤‘ê°„ì— ë­”ê°€ í‹€ë ¸ë‹¤ ì‹¶ìœ¼ë©´&hellip;<br>
<code>kubectl delete -f 03-traefik-services.yml</code> ëª…ë ¹ì–´ë¥¼ í†µí•´<br>
ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì ìš©ì„ í•´ë³´ë©´ ë©ë‹ˆë‹¤.</p>
</li>
<li>
<p>prompt in <code>kubectl tunneling</code> terminal</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>â¯ minikube tunnel
</span></span><span style="display:flex;"><span>âœ…  Tunnel successfully started
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸ“Œ  NOTE: Please <span style="color:#66d9ef">do</span> not close this terminal as this process must stay alive <span style="color:#66d9ef">for</span> the tunnel to be accessible ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ğŸƒ  Starting tunnel <span style="color:#66d9ef">for</span> service traefik-dashboard-service.
</span></span><span style="display:flex;"><span>â—  The service/ingress traefik-web-service requires privileged ports to be exposed: <span style="color:#f92672">[</span>80<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>ğŸ”‘  sudo permission will be asked <span style="color:#66d9ef">for</span> it.
</span></span><span style="display:flex;"><span>ğŸƒ  Starting tunnel <span style="color:#66d9ef">for</span> service traefik-web-service.
</span></span><span style="display:flex;"><span>Password:
</span></span><span style="display:flex;"><span>âœ‹  Stopping tunnel <span style="color:#66d9ef">for</span> service traefik-dashboard-service.
</span></span><span style="display:flex;"><span>âœ‹  Stopping tunnel <span style="color:#66d9ef">for</span> service traefik-web-service.
</span></span><span style="display:flex;"><span>E0204 22:51:14.129905   <span style="color:#ae81ff">25131</span> ssh_tunnel.go:183<span style="color:#f92672">]</span> error stopping ssh tunnel: operation not permitted
</span></span><span style="display:flex;"><span>ğŸƒ  Starting tunnel <span style="color:#66d9ef">for</span> service traefik-dashboard-service.
</span></span><span style="display:flex;"><span>â—  The service/ingress traefik-web-service requires privileged ports to be exposed: <span style="color:#f92672">[</span>80<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>ğŸ”‘  sudo permission will be asked <span style="color:#66d9ef">for</span> it.
</span></span><span style="display:flex;"><span>ğŸƒ  Starting tunnel <span style="color:#66d9ef">for</span> service traefik-web-service.
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Deployment</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-deployment</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">traefik</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">app</span>: <span style="color:#ae81ff">traefik</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">app</span>: <span style="color:#ae81ff">traefik</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">serviceAccountName</span>: <span style="color:#ae81ff">traefik-account</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">image</span>: <span style="color:#ae81ff">traefik:v2.9</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">args</span>:
</span></span><span style="display:flex;"><span>            - --<span style="color:#ae81ff">api.insecure</span>
</span></span><span style="display:flex;"><span>            - --<span style="color:#ae81ff">providers.kubernetesingress</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">web</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">dashboard</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-dashboard-service</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">LoadBalancer</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">port</span>: <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">dashboard</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">traefik</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">traefik-web-service</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">type</span>: <span style="color:#ae81ff">LoadBalancer</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">web</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">traefik</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
</li>
</ul>
</li>
</ul>
<h3 id="04-5-whoami-ì„œë¹„ìŠ¤-ì ìš©">04-5. whoami ì„œë¹„ìŠ¤ ì ìš©</h3>
<ul>
<li>
<p>ì—¬ê¸°ì„œë¶€í„°ëŠ” whoami ì„œë¹„ìŠ¤ê¹Œì§€ ì œëŒ€ë¡œ ë„ë‹¬í•˜ì§€ ì•Šì•„, ì°¸ê³ ë¡œë§Œ í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwd
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ${HOME}/traefik-practice/00_quickstart</span>
</span></span><span style="display:flex;"><span>apply -f 04-whoami-service.yml
</span></span><span style="display:flex;"><span>apply -f 05-whoami-ingress.yml
</span></span></code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Deployment</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">apps/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">whoami</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">whoami</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">matchLabels</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">app</span>: <span style="color:#ae81ff">whoami</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">template</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">app</span>: <span style="color:#ae81ff">whoami</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">whoami</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">image</span>: <span style="color:#ae81ff">traefik/whoami</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">web</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">whoami</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">web</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">port</span>: <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">targetPort</span>: <span style="color:#ae81ff">web</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">selector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">whoami</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">networking.k8s.io/v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Ingress</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">whoami-ingress</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">http</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">paths</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/whoami</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">pathType</span>: <span style="color:#ae81ff">Prefix</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">backend</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">service</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">name</span>: <span style="color:#ae81ff">whoami</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">port</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">name</span>: <span style="color:#ae81ff">web</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
</li>
</ul>
<h2 id="minikube-ìƒíƒœ-ë°-traefik-ëŒ€ì‹œë³´ë“œ-í™•ì¸">minikube ìƒíƒœ ë° traefik ëŒ€ì‹œë³´ë“œ í™•ì¸</h2>
<ul>
<li>
<p>minikube ìƒíƒœ í™•ì¸</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl get svc,pod,ingress
</span></span><span style="display:flex;"><span><span style="color:#75715e">#NAME                                TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)          AGE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#service/kubernetes                  ClusterIP      10.96.0.1       &lt;none&gt;        443/TCP          51m</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#service/traefik-dashboard-service   LoadBalancer   10.102.66.98    127.0.0.1     8080:30024/TCP   50m</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#service/traefik-web-service         LoadBalancer   10.110.10.216   127.0.0.1     80:31761/TCP     50m</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#service/whoami                      ClusterIP      10.99.168.47    &lt;none&gt;        80/TCP           33m</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#NAME                                    READY   STATUS    RESTARTS   AGE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#pod/traefik-deployment-bd6c9d49-rvzns   1/1     Running   0          32m</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#pod/whoami-6d97bf7dcb-r744j             1/1     Running   0          9s</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#NAME                                       CLASS   HOSTS       ADDRESS        PORTS   AGE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ingress.networking.k8s.io/whoami-ingress   nginx   localhost   192.168.49.2   80      10m</span>
</span></span></code></pre></div></li>
<li>
<p>traefik ëŒ€ì‹œë³´ë“œ í™•ì¸</p>
<p><img src="./images/traefik-dashboard.png" alt="traefik-dashboard"></p>
</li>
</ul>
<h2 id="reference">reference</h2>
<ul>
<li><a href="https://doc.traefik.io/traefik/getting-started/quick-start-with-kubernetes/">Traefik Quick Start w/k8s</a></li>
<li><a href="https://faun.pub/kubernetes-whoami-service-with-traefik-650d8311cf9b">faun.pub</a></li>
<li><a href="https://www.notion.so/gasidaseo/CloudNet-Blog-c9dfa44a27ff431dafdd2edacc8a1863">CloudNet@</a></li>
<li><a href="https://www.reddit.com/r/kubernetes/comments/e5dzse/does_traefik_as_ingress_work_in_minikube/">Enable ingress 1</a></li>
<li><a href="https://doc.traefik.io/traefik/v1.7/user-guide/kubernetes/#prerequisites">Enable ingress 2</a></li>
<li><a href="https://medium.com/@Oskarr3/setting-up-ingress-on-minikube-6ae825e98f82">ingress minikube</a></li>
</ul>

  </div>
  </section>
  <section class="p-strip">
    <div class="row">
      <script src="https://giscus.app/client.js"
        data-repo="kkumtree/blog.minseong.xyz"
        data-repo-id="R_kgDOIv-sqA"
        data-category="Blog Comments"
        data-category-id="DIC_kwDOIv-sqM4CW7uO"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="ko"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
      </script>
    </div>
  </section>
  <div class="card w-full bg-base-100 shadow-xl">
  <div class="card-body" id="adbody">
      <script async
          src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1254864146899485"
          crossorigin="anonymous"></script>
      
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1254864146899485"
          data-ad-slot="3556422150" data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
  </div>
  
  <script>
      let adsection = document.getElementsByClassName("adsbygoogle")[0];
      let adfallback = document.getElementById("adfallback");
      adfallback.style.display = "none";
      if (window.getComputedStyle(adsection).display == "none") {
          document.getElementById("adbody").style.display = "none";
          adfallback.style.display = "block";
      } 
  </script>
</div>
  <section class="p-strip--light">
    <div class="row">
      
      <div class="col-12">
        <div class="p-media-object">
          <img src="https://avatars.githubusercontent.com/u/52643858?v=4" class="p-media-object__image is-round" alt="">
          <div class="p-media-object__details">
            <h3 class="p-media-object__title">
              <a href="#">kkumtree</a>
            </h3>
            <p class="p-media-object__content">plumber for infra</p>
            <ul class="p-inline-list--middot">
              <li class="p-inline-list__item"><a href="mailto:mscho@ubuntu-kr.org">Email</a></li>
              <li class="p-inline-list__item"><a href="https://launchpad.net/~mscho7969">Launchpad</a></li>
              <li class="p-inline-list__item"><a href="https://github.com/kkumtree">GitHub</a></li>
            </ul>
          </div>
        </div>
         
    </div>
  </section>
  <section class="p-strip">
    <div class="row">
      <footer class="p-article-pagination">
        
        
        <a class="p-article-pagination__link--next" href="/post/basic-aws-troubleshooting/">
          <span class="p-article-pagination__label">Next</span>
          <span class="p-article-pagination__title">AWS íŠ¸ëŸ¬ë¸” ìŠˆíŒ… - 7ì£¼ ê°„ì˜ k8s ì‹¤ë¬´ ìŠ¤í„°ë””ë¥¼ ë§ˆì¹˜ë©°</span>
        </a>
        
      </footer>
    </div>
  </section>
</main>

        </div><section class="p-strip--accent">
  <div class="row">
    <div class="col-12">
      <h2>kkumtree</h2>
      <ul class="p-inline-list--middot is-dark">
        <li class="p-inline-list__item">
          <a href="mailto:mscho@ubuntu-kr.org">Contact with (Email)</a>
        </li>
        
        
        
        <li class="p-inline-list__item">
          <a href="https://github.com/kkumtree">GitHub</a>
        </li>
        <li class="p-inline-list__item">
          <a href="https://launchpad.net/~mscho7969">Launchpad</a>
        </li>
      </ul>
      <p></p>
      <a href="https://github.com/kkumtree/blog.minseong.xyz">Source code on GitHub</a>
    </div>
  </div><script type="text/javascript" src='/js/v-framework.js'></script>
<script type="text/javascript" src='/js/timedisplay.js'></script>
<script>

let slides = document.getElementsByClassName("main-slide");
let index = 0;
let count = slides.length;
function setSlideIndex(destination) {
    index = destination % count;
    index = index < 0 ? index * -1 : index;
    for (let i = 0; i < count; i++) {
        if(i == index) {
            slides[i].style.display = "block";
        } else {
            slides[i].style.display = "none";
        }
    }
}
function nextSlide() {
    setSlideIndex(index + 1);
}
function prevSlide() {
    setSlideIndex(index - 1);
}
setSlideIndex(0);
setInterval(nextSlide, 5000);
</script>

</body>
</html>
